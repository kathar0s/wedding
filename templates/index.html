{% extends "base.html" %}
{% load staticfiles %}
{% block body %}
	<div class="chat-wrapper">
		<div class="title">
			<button class="btn btn-back">
				<i class="fa fa-angle-left"></i>
				한의주 ♡ 형정석
			</button>
			<button class="btn btn-menu pull-right">
				<i class="fa fa-bars"></i>
			</button>
		</div>
		<div class="talk-box">
			<div class="scroller">
{#						<a id="test">테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br>테스트<br></a>#}
{#						<div style="height: 2000px"></div>#}
			</div>
		</div>
		<div class="input-box">
			<button class="btn btn-plus"><i class="fa fa-plus"></i></button>
			<textarea rows="1"></textarea>
			<button class="btn btn-send" disabled>전송</button>
		</div>
	</div>
	<!-- 사이드 메뉴 영역 -->
	<div class="menu-wrapper">

	</div>
	<!-- 스플래쉬 영역 -->
	<div class="splash-wrapper">
		<div class="countdown">
			<p>2016.04.30. SAT PM 3:00</p>
			<h1>D-29</h1>
		</div>
		<div class="detail-wrapper">
			<button class="btn btn-primary btn-brd" id="show-detail">자세히보기 <i class="fa fa-angle-right"></i></button>
		</div>
	</div>
{% endblock %}
{% block javascript %}
<script src="{% static "assets/js/plugins/jquery.elastic.js" %}"></script>
<script>
	$(document).ready(function(){
		$('#test').on('click', function(e){
			toggleFullScreen();
		});

		resizeInputBox();
		resizeMenuBox();
		centeredText();

		$(window).on('resize', function(e){
			resizeTalkBox();
			resizeInputBox();
			resizeMenuBox();
			centeredText();
		});
		resizeTalkBox();
		initSideMenu();
		initInputBox();

		$('#show-detail').on('click', function(e){
			$('.splash-wrapper').fadeOut();
		});

		$('.title .btn-back').on('click', function(e){
			$('.splash-wrapper').fadeIn();
		});
	});

	function initInputBox() {

		$('textarea').on('keyup', function(e){

			var _text = $(this).val();

			this.style.height = "1px";
			this.style.height = this.scrollHeight+"px";

			resizeInputBox();
			resizeTalkBox();

			if (_text.length > 0) {
				$('.btn-send').removeAttr('disabled');
			} else {
				$('.btn-send').attr('disabled', 'disabled');
			}
		});

		$('textarea').on('keydown', function(e){
			if (e.keyCode == 13 && !e.shiftKey) {
				e.preventDefault();

				// 엔터받으면 전송하도록 한다.
				sendMessage();
			}
		});

		$('.btn-send').on('click', function(){
			sendMessage();
		});
	}

	function sendMessage() {
		var _textarea = $('textarea');
		_textarea.val('');
		_textarea.trigger('keyup');

		_textarea.focus();
	}

	function resizeMenuBox() {
		var width = $(window).width() - 80;
		var right = -(width + 40);

		$('.menu-wrapper').css({'width': width, 'right': right});
	}

	function initSideMenu() {
		$('.btn-menu').on('click', function(e){
			$('.menu-wrapper').addClass('active');
			$('.overlay').addClass('active');
		});

		$('.overlay').on('click', function(e) {
			$('.menu-wrapper').removeClass('active');
			$(this).removeClass('active');
		});
	}

	function centeredText() {
		var _name = $('.splash-wrapper .names');

		var _height = $(window).height();

		_name.css({'bottom': _height * 45 / 100});
	}

	function resizeInputBox(){
		var _textarea = $('.input-box textarea');
		var height = _textarea.outerHeight();

		$('.input-box').height(height);
		$('.btn-plus').outerHeight(height);

		_textarea.outerWidth($(window).width() - 48);
	}

	function resizeTalkBox(){
		var height = $(window).height();
		var input_height = $(".chat-wrapper .input-box").outerHeight();
		var title_height = $(".chat-wrapper .title").outerHeight();

		$('.scroller').height(height-title_height-input_height);
	}

	function toggleFullScreen() {
		if (!document.fullscreenElement &&    // alternative standard method
				!document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement ) {  // current working methods
			if (document.documentElement.requestFullscreen) {
				document.documentElement.requestFullscreen();
			} else if (document.documentElement.msRequestFullscreen) {
				document.documentElement.msRequestFullscreen();
			} else if (document.documentElement.mozRequestFullScreen) {
				document.documentElement.mozRequestFullScreen();
			} else if (document.documentElement.webkitRequestFullscreen) {
				document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
			}
		} else {
			if (document.exitFullscreen) {
				document.exitFullscreen();
			} else if (document.msExitFullscreen) {
				document.msExitFullscreen();
			} else if (document.mozCancelFullScreen) {
				document.mozCancelFullScreen();
			} else if (document.webkitExitFullscreen) {
				document.webkitExitFullscreen();
			}
		}
	}
</script>
<script type="text/jsx">
	// React Code Goes Here
</script>
{% endblock %}